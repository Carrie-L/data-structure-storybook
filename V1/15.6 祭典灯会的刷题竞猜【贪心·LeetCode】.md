### **15.6 祭典灯会的刷题竞猜【贪心·LeetCode】**

*"灯火阑珊处，谜题千万重。唯有洞悉那‘局部最优’的真意，方能于璀璨光影中，摘得最终的胜利之花。"*

秋日祭典的最后一晚，是热闹非凡的灯会。无数盏写着谜题的灯笼被高高挂起，将整个校园装点得如同梦幻之境。女孩们决定，将本章的最终试炼，融入到这场有趣的猜灯谜活动中。

“今晚的规则很简单，”希娅宣布道，她将挑选好的LeetCode题目，事先写成了灯谜，挂在了一盏巨大的走马灯上，“我们一盏一盏地来解。这些谜题，都需要我们用‘贪心’的眼光去审视。”

#### **第一盏灯：跳跃的游戏 (Jump Game)**

第一盏灯上画着一个小人，在一连串的石头上跳跃，谜题是：**LC 55. 跳跃游戏**。

“题目给出一个非负整数数组`nums`，你最初位于数组的第一个位置。数组中的每个元素代表你在该位置可以跳跃的最大长度。判断你是否能够到达最后一个位置。”

“这个问题……”安妮看着灯谜，思索起来，“我站在一个位置，可能会有很多选择。比如我在一个数字是`3`的石头上，我可以选择跳1步、2步或3步。我该怎么选才是最好的呢？”

“动态规划似乎可以解，”黛芙分析道，“`dp[i]`表示能否到达位置`i`。但复杂度可能是O(N²)。有没有更快的贪心策略？”

“我好像有点想法！”安妮说，“我不需要关心‘怎么跳’，我只需要关心‘我最远能跳到哪里’！我从起点开始，一步步往前走，在路上不断地更新我能到达的‘最远覆盖范围’。只要这个范围在中途没有断掉（即我走到了一个位置，但这个位置已经超出了我之前能到达的最远范围），并且最终这个范围能覆盖到终点，那我就赢了！”

“非常精彩的贪心思路！”伊莎贝尔赞道，“你的贪心标准是：**在每一步，都尽可能地去扩展和维护一个‘最远可达’的边界。**”

```python
def can_jump(nums: list[int]) -> bool:
    max_reach = 0 # 当前能到达的最远位置
    for i, num in enumerate(nums):
        # 如果当前位置i已经超出了我能到达的最远距离，则失败
        if i > max_reach:
            return False
        # 更新最远可达距离
        max_reach = max(max_reach, i + num)
    return True # 循环结束，说明可以走到最后
```

“这个解法只遍历了一次数组，时间复杂度是O(N)，非常高效！”黛芙总结道。

#### **第二盏灯：加油站的抉择 (Gas Station)**

第二盏灯上画着一辆小汽车和几个加油站，谜题是：**LC 134. 加油站**。

“一条环形路上有N个加油站，每个加油站可以加`gas[i]`的油，而从第`i`站到第`i+1`站需要消耗`cost[i]`的油。你需要找到一个出发点，使得汽车能绕行一圈回到起点。如果不存在，则返回-1。”

“这个问题好复杂，”希娅挠了挠头，“如果我从每个点都出发试一次，那复杂度就是O(N²)了。”

“我们来思考一下，”黛芙引导道，“如果我从A点出发，开到B点时，发现油不够了，这意味着什么？”

“意味着……从A到B之间的任何一个点出发，都不可能到达B点！”安妮抢答道，“因为如果能从中间的某个点C出发到达B，那我从A开到C时，油箱里的油肯定是正数，只会更有利，既然这样都到不了B，那说明从A到B这段路本身就是‘入不敷出’的！”

“完美的推理！”黛芙非常高兴，“所以，一旦我们从`start`点出发，在`i`点失败了，我们就知道，下一次的出发点，最早也得是`i+1`。这就排除掉了大量的可能性！”

**贪心策略：**
1.  用一个变量`total_tank`记录总的油量盈余，如果最终`total_tank < 0`，说明总的油量都不够消耗，肯定无解。
2.  用一个变量`current_tank`记录当前从出发点`start`开始的油量。一旦`current_tank < 0`，就说明从`start`出发的尝试失败了。我们就把下一个位置`i+1`作为新的`start`，并重置`current_tank`。

```python
def can_complete_circuit(gas: list[int], cost: list[int]) -> int:
    if sum(gas) < sum(cost):
        return -1
    
    start_station = 0
    current_tank = 0
    for i in range(len(gas)):
        current_tank += gas[i] - cost[i]
        if current_tank < 0:
            # 从当前出发点失败，尝试下一个点
            start_station = i + 1
            current_tank = 0
            
    return start_station
```

“这个算法也只遍历了一次数组，时间复杂度O(N)。它通过一个聪明的贪心逻辑，避免了大量的重复尝试。”

灯会的喧嚣渐渐远去，但女孩们心中的思辨之火，却愈发旺盛。她们明白了，贪心算法，往往不是去解决一个“求最优值”的问题，而是去解决一个“做最优决策”的问题。它要求我们有一种洞察力，能从纷繁的表象中，找到那个指引我们走向胜利的、最关键的“航标”。

---

🌸 **贪心应用核心要点** 🌸

**1. 算法设计的根本思想**
- **寻找决策的“不变量”或“单调性”：** 成功的贪心算法，往往能发现问题背后隐藏的某种规律。例如，在跳跃游戏中，“最远可达范围`max_reach`”是一个只增不减的量。在加油站问题中，“若从A到B油不够，则A到B之间的任意点出发都到不了B”是一个关键的推论。
- **一次遍历解决问题：** 许多精妙的贪心算法，最终都表现为对问题的一次线性扫描。在扫描过程中，通过维护一个或几个关键变量（如`max_reach`, `current_tank`），来做出实时的、正确的贪心决策。
- **反证法是试金石：** 当你构思出一个贪心策略时，要反复地质问自己：“这个选择会让我错失最优解吗？”尝试用反证法去证明，如果我不这么选，结果会不会更好。这个思辨过程，是贪心算法学习的精髓。

**2. 核心设计哲学**
- **问题的转化与建模：** 很多问题本身看起来并不像贪心问题。我们需要将其转化为一个“每一步如何做选择”的模型。例如，跳跃游戏可以看作是“每一步如何选择跳跃的落点，以最大化下一次的起跳范围”。
- **局部信息的最大化利用：** 贪心算法在每一步，都充分利用了当前所能获得的局部信息，并做出了最有利的判断。它相信，只要每一步都走对，最终就能到达终点。
- **与DP的界限：** 有些问题，看似可以用贪心，但仔细分析后会发现，当前的选择会影响未来的选择空间，导致贪心失效（如0-1背包）。而另一些问题，当前的选择虽然也影响未来，但它总是以一种“有利”的方式影响（如活动选择），从而使得贪心成立。辨别这两种“影响”的差异，是区分贪心和DP的关键。

**3. 算法思维的启发**
- **“未来”与“过去”：** 动态规划通常是“回头看”的，`dp[i]`依赖于`dp[i-1]`等过去的状态。而很多贪心算法是“向前看”的，它通过当前的选择，去影响和优化一个代表“未来”的指标（如`max_reach`）。
- **逻辑链的构建：** 贪心算法的正确性，往往依赖于一条严谨的逻辑推理链。例如加油站问题中的那个关键推论。锻炼这种从问题现象中推导本质规律的能力，是提升算法水平的重要途径。
- **大胆假设，小心求证：** 面对一个优化问题，不妨先大胆地提出一个最直观的贪心策略，然后像安妮一样，去寻找反例来攻击它。这个过程，远比直接看答案要收获更多。

---

🎀 **安妮的小小日记本**

今晚的灯会刷题，比逛祭典本身还有趣！

我发现，贪心类的题目，就像一个个脑筋急转弯。它们不像DP那样有固定的“套路”可以走，而是需要灵光一闪，找到那个解决问题的“金钥匙”。

比如“跳跃游戏”，我一开始总在纠结“我这一步到底该跳多远”，结果就陷进了复杂的选择里。但换个思路，去想“我最多能跳多远”，问题一下子就变简单了！

还有“加油站”问题，那个“如果从A到不了B，那中间任何地方也到不了B”的结论，简直就像一句魔法咒语，一下子就把O(N²)的暴力解法给“降维”成了O(N)！

我感觉，做贪心题，就像是在和出题人进行一场智力博弈。他把真正的线索，隐藏在问题的描述和约束里，而我，需要像一个侦探一样，发现它，并利用它！这种感觉，太刺激了！

---

### 今日关键词

- **贪心标准 (Greedy Criterion):** （回顾）在贪心算法中，用于进行局部最优选择的规则或标准。例如，在跳跃游戏中是“最大化覆盖范围”，在加油站问题中是“失败后移动到下一个起点”。
- **一次遍历 (Single Pass):** 指算法通过对数据集进行一次完整的线性扫描来解决问题，通常对应O(N)的时间复杂度。

### 推荐练习题目 🧲  
> 难度标注：⭐ = Easy ⭐⭐ = Mediumn> 建议顺序：基础 ➜ 进阶 ➜ 面试
> （本章的练习题已在15.1至15.5节中详细列出，此处不再重复。请参考之前的推荐列表，深入练习不同模型的贪心问题。）
