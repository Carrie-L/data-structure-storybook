# 第03章 珍珠项链的秘密

*单向链表如同一串精美的珍珠项链，每颗珍珠都知道下一颗在哪里，但不需要知道前面发生了什么。有时候，放下对过去的执念，专注当下的连接，反而能走得更远。*

周三的早晨，DSA Lab被轻柔的春雨声包围着。安妮比平时早到了半小时，她坐在靠窗的位置，手里捧着一杯热可可，静静地看着雨滴在玻璃窗上画出蜿蜒的轨迹。

她正在整理昨天学习动态数组时的笔记，突然遇到了一个新问题：如何在数据中间插入新元素？

"如果我想在第3个位置插入一个新的温度数据，"安妮对着空气自言自语，"动态数组就需要把后面所有的元素都往后移动一位...这样好麻烦啊。"

她在纸上画了个简图：
```
原数组: [22.5][23.1][24.8][23.7][22.9]
插入25.0到位置2: [22.5][23.1][25.0][24.8][23.7][22.9]
需要移动: [24.8][23.7][22.9] → [24.8][23.7][22.9]
```

"这样每次插入都要移动好多元素，感觉效率不高..."

"遇到什么难题了？"伊莎贝尔的温柔声音从身后传来。

安妮回头，看到伊莎贝尔正放下雨伞，手里还提着一个小纸袋。"贝尔姐，早上好！我在想数组插入的问题，感觉好复杂。"

伊莎贝尔坐到安妮身边，从纸袋里取出两个刚出炉的可颂面包，香气四溢。"你知道吗，这正是数组的一个限制。不过，有一种数据结构专门解决这个问题。"

"真的吗？"安妮接过温热的可颂，眼睛亮了起来。

"当然，那就是链表。"伊莎贝尔打开笔记本，"你有见过珍珠项链吗？"

"见过！我妈妈有一条很漂亮的珍珠项链。"

伊莎贝尔温和地笑了："链表就像珍珠项链一样。每颗珍珠就是一个节点，它不仅包含数据（珍珠本身），还有一根线连接到下一颗珍珠。"

她在屏幕上画出了一个简单的示意图：

```
数据节点的结构：
┌─────────┬──────────┐
│  数据   │ 指向下一个 │
│ (22.5)  │   节点   │
└─────────┴──────────┘
     ↓
┌─────────┬──────────┐
│  数据   │ 指向下一个 │
│ (23.1)  │   节点   │
└─────────┴──────────┘
     ↓
┌─────────┬──────────┐
│  数据   │ 指向下一个 │
│ (24.8)  │   null   │
└─────────┴──────────┘
```

"哇！每个节点都知道下一个在哪里！"安妮咬了一口可颂，脸颊因为理解了新概念而微微发红。

这时，希娅推门进来，抖掉伞上的雨水。"早安！咦，你们这么早就开始学习新东西了？"

"我们在研究链表呢！"安妮兴奋地招手，"希娅姐快来看，这个太有趣了！"

希娅走过来，看了看屏幕上的图示："哦，单向链表！这确实是个很优雅的数据结构。"

伊莎贝尔开始编写代码来演示，她边写边解释每一行的作用：

```python
# 首先定义一个节点类，就像单个珍珠的设计图
class ListNode:
    def __init__(self, data):
        self.data = data      # 存储实际数据，比如温度值
        self.next = None      # 指向下一个节点的"线"，开始时是空的

# 然后定义整条链表，就像整条项链的管理者
class LinkedList:
    def __init__(self):
        self.head = None      # 头指针，记录第一颗珍珠在哪里
    
    # 在链表末尾添加新节点（像在项链末尾加新珍珠）
    def append(self, data):
        new_node = ListNode(data)     # 创建一颗新珍珠
        
        # 如果项链是空的，新珍珠就是第一颗
        if not self.head:
            self.head = new_node
            return
        
        # 否则，找到最后一颗珍珠
        current = self.head           # 从第一颗开始
        while current.next:           # 沿着线一直走到最后
            current = current.next
        
        # 把新珍珠连到最后一颗后面
        current.next = new_node
    
    # 在指定位置插入新节点（在项链中间加新珍珠）
    def insert_at(self, index, data):
        new_node = ListNode(data)     # 创建新珍珠
        
        # 如果要插在最前面，让新珍珠成为第一颗
        if index == 0:
            new_node.next = self.head # 新珍珠指向原来的第一颗
            self.head = new_node      # 头指针指向新珍珠
            return
        
        # 否则，找到要插入位置的前一个节点
        current = self.head
        for i in range(index - 1):    # 走到插入位置的前一个
            if current.next:
                current = current.next
        
        # 插入新珍珠：先连到后面，再连到前面
        new_node.next = current.next  # 新珍珠连到后面的珍珠
        current.next = new_node       # 前面的珍珠连到新珍珠
```

"哇，这样写我就看懂了！"安妮兴奋地说，"每一步都有解释，感觉不难呢！"

希娅指着插入函数说："看这里，插入操作只需要改变两个连接，不管链表有多长都是一样的步骤。"

就在这时，黛芙走了进来，她看起来比昨天精神了许多。"早上好，看起来你们已经进入状态了。"

"黛芙姐！"安妮高兴地说，"我们在学链表，感觉比数组灵活好多呢！"

黛芙在她们旁边坐下，看了看代码："链表确实有它的优势。插入和删除操作的时间复杂度是O(1)，这比数组的O(n)要高效得多。"

"时间复杂度？O(1)？"安妮好奇地眨眨眼，"这些符号是什么意思呀？"

伊莎贝尔温和地解释："时间复杂度就是衡量算法快慢的方法。O(1)意思是'常数时间'，不管数据有多少，操作时间都是固定的。"

"就像开门一样，"希娅比划着，"不管房间里有10个人还是1000个人，开门的动作都只需要转一下门把手，时间是固定的。"

黛芙点点头："对于链表来说，如果我们已经找到了要插入的位置，那么插入操作就只需要：第一步，让新节点指向后面的节点；第二步，让前面的节点指向新节点。就两个步骤，所以是O(1)。"

安妮恍然大悟："所以不管链表有10个节点还是10000个节点，插入都只需要改变两个连接？"

"完全正确！"黛芙赞赏地看着安妮，"这就是为什么说是O(1)。而数组就不同了，如果要在中间插入，后面所有元素都要挪位置，数据越多，挪的元素就越多，所以是O(n)。"

希娅补充道："n代表数据的数量。O(n)意思是操作时间会随着数据量线性增长。"

"哦！"安妮兴奋地拍手，"就像搬家一样！链表插入新东西，就像在房间里加一把椅子，只要放进去就行了。但是数组插入，就像在排队的人群中间插队，后面所有人都要往后挪一步！"

"这个比喻太棒了！"伊莎贝尔笑着说。

她们一起实现了一个完整的温度记录链表：

```python
# 创建一个空的温度记录链表
temp_list = LinkedList()
daily_temps = [22.5, 23.1, 24.8, 23.7, 22.9]

# 把每天的温度依次加入链表
for temp in daily_temps:
    temp_list.append(temp)     # 在末尾添加温度数据

# 假设我们发现第2天的数据有问题，想在第2个位置插入修正值
temp_list.insert_at(2, 25.0)  # 插入修正后的温度

print("插入完成！只改变了两个连接，其他数据都没有移动。")
```

"真的很神奇，"安妮边操作边感叹，"插入新数据这么简单，完全不需要移动其他数据。"

黛芙补充道："但是要记住，链表也有自己的代价。如果我们想找第10个节点，就必须从头开始一个一个往下走，这个查找过程是O(n)的。"

"所以，"希娅总结道，"数组擅长查找（O(1)），但插入删除慢（O(n)）；链表擅长插入删除（O(1)），但查找慢（O(n)）。它们各有优势。"

安妮若有所思地点点头："所以链表教会我们专注当下的连接，而不是总想着跳跃到很远的地方？"

"这个理解很深刻，"黛芙的眼中闪过一丝温暖，"有时候，接受这种'只能前进'的限制，反而能让我们更专注于当前的选择。"

"就像我们四个人一样，"伊莎贝尔轻声说道，"每个人都有自己的特点和位置，但我们之间的联系让我们成为一个团队。"

黛芙静静地听着，心中涌起一阵暖流。昨天她还在为如何领导团队而烦恼，今天却发现，也许最好的领导方式不是控制每个人的位置，而是建立起良好的连接，让团队自然地运作。

"我想我开始理解了，"黛芙轻声说道，"有时候，放下对全局的控制欲，专注于建立好的连接，反而能让整个系统更加灵活和高效。"

窗外的春雨还在轻柔地下着，实验室里四个女孩围坐在一起，共同探索着数据结构的奥秘。她们发现，每一种数据结构都像是一种生活哲学，教会她们用不同的角度去理解世界。

"下次我们学什么？"安妮充满期待地问道。

"双向链表，"希娅神秘地眨眨眼，"那样我们就不仅能向前看，还能回头看了。"

"听起来很有趣呢！"安妮开心地说，"感觉我们的数据结构之旅才刚刚开始。"

雨声轻柔，友谊深深，知识在她们之间流淌，就像一条美丽的链表，每个节点都珍贵而独特，每个连接都温暖而牢固。


> 单向链表（Singly Linked List）：元素以节点形式链接，每节点含数据与指向下一节点的指针，便于动态插入与删除。

> 推荐练习题：LeetCode 206.反转链表, 21.合并两个有序链表, 141.环形链表, 83.删除排序链表中的重复元素, 203.移除链表元素 